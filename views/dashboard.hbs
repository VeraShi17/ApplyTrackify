<div class="accordion" id="dashboardAccordion">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingToday">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseToday" aria-expanded="true" aria-controls="collapseToday">
        Today's Deadlines
      </button>
    </h2>
    <div id="collapseToday" class="accordion-collapse collapse show" aria-labelledby="headingToday">
      <div class="accordion-body">
        {{#each todayTrackers}}
          <p>{{this.university}} - {{this.program}} - <a href="/dashboard/{{this.graduateTrackerList.slug}}">{{this.graduateTrackerList.name}}</a></p>
        {{/each}}
        {{#unless todayTrackers.length}}
          <p>No trackers due today.</p>
        {{/unless}}
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingRecent">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRecent" aria-expanded="false" aria-controls="collapseRecent">
        Recent Deadlines
      </button>
    </h2>
    <div id="collapseRecent" class="accordion-collapse collapse" aria-labelledby="headingRecent">
      <div class="accordion-body">
        {{#each recentTrackers}}
          <p>{{this.university}} - {{this.program}} - <a href="/dashboard/{{this.graduateTrackerList.slug}}">{{this.graduateTrackerList.name}}</a> - {{this.deadline}}</p>
        {{/each}}
        {{#unless recentTrackers.length}}
          <p>No recent trackers found.</p>
        {{/unless}}
      </div>
    </div>
  </div>
</div>


<div class="list-group">
  {{#each lists as |list|}}
    <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
      <a href="/dashboard/{{list.slug}}">{{list.name}}</a>
      <div class="d-grid gap-2 d-md-block">
        {{!-- <button class="btn btn-primary" type="button">Rename</button> --}}
        <button class="btn btn-primary" onclick="renameList('{{list.slug}}')">Rename</button>
        <!-- Delete Form -->
        <form action="/dashboard/delete-list" method="POST" onsubmit="return confirm('Are you sure?');">
            <input type="hidden" name="slug" value="{{list.slug}}">
            <button class="btn btn-secondary" type="submit">Delete</button>
        </form>
      </div>
    </div>
  {{/each}}
  <div class="list-group-item" id="creater">
    <form action="/dashboard/create-list" method="POST" class="d-flex justify-content-between align-items-center">
      <input type="text" name="listName" class="form-control" placeholder="List name" aria-label="List name">
      <button type="submit" class="btn btn-primary">Create a new list</button>
    </form>
  </div>
</div>

<script>
function renameList(slug) {
  const newName = prompt("Please enter the new name for the list:");
  if (newName) {
    fetch('/dashboard/rename-list', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ slug, newName }),
    }).then(response => {
      if (response.ok) {
        window.location.reload(); 
      }
    });
  }
}
</script>